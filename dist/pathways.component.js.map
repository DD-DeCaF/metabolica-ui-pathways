{"version":3,"sources":["pathways.component.ts"],"names":[],"mappings":"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","file":"pathways.component.js","sourcesContent":["// Turn of WS TS inspection for the 'decaf-common' import.\n// noinspection TypeScriptCheckImport\nimport {Config, dirname} from 'decaf-common';\nimport './pathways.component.css!';\nimport './escher-builder.css!';\nimport 'jquery';\nimport escher, {EscherService} from './escher.service';\nimport pathways, {PathwaysService} from './pathways.service';\n\n\nexport const COMPONENT_NAME = 'pathways';\nconst pathwaysModule = angular.module(COMPONENT_NAME, [\n\tescher.name,\n\tpathways.name\n]);\n\npathwaysModule.config(function (platformProvider) {\n\tplatformProvider\n\t\t.register(COMPONENT_NAME)\n\t\t.state(COMPONENT_NAME, {\n\t\t\turl: `/${COMPONENT_NAME}`,\n\t\t\tviews: {\n\t\t\t\t'content@': {\n\t\t\t\t\ttemplateUrl: `${dirname(module.id)}/pathways.component.html`,\n\t\t\t\t\tcontroller: PathwaysController,\n\t\t\t\t\tcontrollerAs: 'pathwaysController'\n\t\t\t\t}\n\t\t\t}\n\t\t});\n});\n\n\ninterface FormConfig {\n\ttitle: string;\n\tattr: string;\n\tplaceholder: string;\n\tlist: () => any[];\n}\n\nclass PathwaysController {\n\tisDisabled: boolean;\n\tisWaiting: boolean;\n\tmodels: any[];\n\tuniversalModels: any[];\n\tcarbonSources: any[];\n\tproducts: any;\n\tformConfig: FormConfig[];\n\tsearchTexts: any;\n\tmessage: string;\n\tproduct: any;\n\tmodel: any;\n\tuniversalModel: any;\n\tcarbonSource: any;\n\tdata: any;\n\tmapIdPrefix: string;\n\tpathwaysService: PathwaysService;\n\tescherService: EscherService;\n\tprivate $timeout: angular.ITimeoutService;\n\n\tconstructor($timeout, PathwaysService: PathwaysService, EscherService: EscherService) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.isDisabled = false;\n\t\tthis.isWaiting = false;\n\t\tthis.models = [];\n\t\tthis.universalModels = [];\n\t\tthis.products = {};\n\t\tthis.carbonSources = [];\n\t\tthis.pathwaysService = PathwaysService;\n\t\tthis.escherService = EscherService;\n\t\tthis.loadLists();\n\t\tthis.formConfig = [\n\t\t\t{\n\t\t\t\t'title': 'Universal model',\n\t\t\t\t'attr': 'universalModels',\n\t\t\t\t'placeholder': 'metanetx_universal_model_bigg_rhea_kegg',\n\t\t\t\t'list': () => this.universalModels\n\t\t\t},\n\t\t\t{\n\t\t\t\t'title': 'Model',\n\t\t\t\t'attr': 'models',\n\t\t\t\t'placeholder': 'iJO1366',\n\t\t\t\t'list': () => {\n\t\t\t\t\treturn this.models.concat([{\n\t\t\t\t\t\tvalue: this.searchTexts.universalModels,\n\t\t\t\t\t\tdisplay: this.searchTexts.universalModels\n\t\t\t\t\t}]);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t'title': 'Carbon source',\n\t\t\t\t'attr': 'carbonSources',\n\t\t\t\t'placeholder': 'EX_glc_lp_e_rp_',\n\t\t\t\t'list': () => this.carbonSources\n\t\t\t},\n\t\t\t{\n\t\t\t\t'title': 'Product',\n\t\t\t\t'attr': 'products',\n\t\t\t\t'placeholder': '',\n\t\t\t\t'list': () => this.products[this.searchTexts.universalModels]\n\t\t\t}\n\t\t];\n\n\t\tthis.searchTexts = {};\n\t\tthis.defaultSearchValues();\n\t\tthis.message = '';\n\t\tthis.product = undefined;\n\t\tthis.data = [];\n\t\tthis.mapIdPrefix = 'mapContainer';\n\t}\n\tdefaultSearchValues() {\n\t\tthis.formConfig.forEach((value) => {\n\t\t\tthis.searchTexts[value.attr] = value.placeholder;\n\t\t});\n\t}\n\tquerySearch (query, data) {\n\t\treturn query ? data.filter( this.createFilterFor(query) ) : data;\n\t}\n\tcreateFilterFor(query) {\n\t\tvar lowercaseQuery = angular.lowercase(query);\n\t\treturn function filterFn(option) {\n\t\t\treturn (angular.lowercase(option.display).indexOf(lowercaseQuery) !== -1);\n\t\t};\n\t}\n\tloadLists() {\n\t\tthis.loadAllUniversalModels();\n\t\tthis.loadAllModels();\n\t\tthis.loadAllCarbonSources();\n\t}\n\tloadAllModels() {\n\t\tthis.pathwaysService.loadModels()\n\t\t\t.then((data: any) => {\n\t\t\t\tdata.data.forEach((value) => {\n\t\t\t\t\tthis.models.push({\n\t\t\t\t\t\tvalue: value.id,\n\t\t\t\t\t\tdisplay: value.name + ' (' + value.id + ')'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tloadAllUniversalModels() {\n\t\tthis.pathwaysService.loadUniversalModels()\n\t\t\t.then((data: any) => {\n\t\t\t\tdata.data.forEach((value) => {\n\t\t\t\t\tthis.universalModels.push({\n\t\t\t\t\t\tvalue: value.id,\n\t\t\t\t\t\tdisplay: value.name\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.loadAllProducts();\n\t\t\t});\n\t}\n\n\tloadAllProducts() {\n\t\tangular.forEach(this.universalModels, (value) => {\n\t\t\tlet universalModelId = value.value;\n\t\t\tthis.products[universalModelId] = [];\n\t\t\tthis.pathwaysService.loadProducts(universalModelId)\n\t\t\t\t.then((data: any) => {\n\t\t\t\t\t\tdata.data.forEach((productValue) => {\n\t\t\t\t\t\t\tthis.products[universalModelId].push({\n\t\t\t\t\t\t\t\tvalue: productValue.id,\n\t\t\t\t\t\t\t\tdisplay: productValue.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t}, this.products);\n\t}\n\n\tloadAllCarbonSources() {\n\t\tthis.pathwaysService.loadCarbonSources()\n\t\t\t.then((data: any) => data.data.forEach((value) => {\n\t\t\t\tthis.carbonSources.push({\n\t\t\t\t\tvalue: value.id,\n\t\t\t\t\tdisplay: value.name\n\t\t\t\t});\n\t\t\t}));\n\t}\n\n\tsubmit() {\n\t\tthis.data = [];\n\t\tthis.message = '';\n\t\tthis.model = this.searchTexts.models;\n\t\tthis.product = this.searchTexts.products;\n\t\tthis.universalModel = this.searchTexts.universalModels;\n\t\tthis.carbonSource = this.searchTexts.carbonSources;\n\t\tthis.isWaiting = true;\n\n\t\tlet tick = () => {\n\t\t\tthis.pathwaysService\n\t\t\t\t.getStatus(this.universalModel, this.model, this.carbonSource, this.product)\n\t\t\t\t.then((statusResponse) => this.pathwaysService\n\t\t\t\t\t.getPathways(this.universalModel, this.model, this.carbonSource, this.product)\n\t\t\t\t\t.then((dataResponse: any) => [statusResponse.status, dataResponse]))\n\t\t\t\t.then(\n\t\t\t\t\t// Success\n\t\t\t\t\t([status, dataResponse]) => {\n\t\t\t\t\t\tlet data: any[] = dataResponse.data;\n\t\t\t\t\t\tfor (var i = this.data.length; i < data.length; i += 1) {\n\t\t\t\t\t\t\tthis.data.push(data[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (status === 202) {\n\t\t\t\t\t\t\tthis.$timeout(tick, 1000);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.isWaiting = false;\n\t\t\t\t\t\t\tif (data.length === 0) {\n\t\t\t\t\t\t\t\tthis.message = 'Pathways not found';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t// Error\n\t\t\t\t\t([status, dataResponse]) => {\n\t\t\t\t\t\tthis.isWaiting = false;\n\t\t\t\t\t\tif (status === 404) {\n\t\t\t\t\t\t\tthis.message = 'No such key';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t};\n\n\t\ttick();\n\t}\n\n}\n\nexport default pathwaysModule;\n"],"sourceRoot":"/source/"}